% read input data generated by compute_moment_stats (C++ code)
% note '~' doesn't seem to work in path?
pop_data_reps = read_MixMapper_input('../../../../data/mixmapper_data/popgen');

% choose populations for scaffold tree
scaffold_pop_names = {'LMULB' 'MIDARK' 'MISS' 'SKIA' 'WHITE'};

% run bootstrap reps in parallel
% matlabpool open 4   

options.branch_sets = 1;
% fit Sardinian as two-way admixture
[trees,fits] = MixMapper(pop_data_reps(1:200),scaffold_pop_names,'ELK','',options);

% fit Mozabite as three-way admixture (with one branch off Sardinian)
% [trees,fits] = MixMapper(pop_data_reps(1:4),scaffold_pop_names,'Sardinian','Mozabite',options);

% write tree from all-data run in Newick format
phytreewrite('tree1.tree',trees(1));
