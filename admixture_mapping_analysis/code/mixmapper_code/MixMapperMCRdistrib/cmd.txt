% read input data generated by compute_moment_stats (C++ code)
% note '~' doesn't seem to work in path?
pop_data_reps = read_MixMapper_input('example/panel4_thinned_MixMapper');

% choose populations for scaffold tree
scaffold_pop_names = {'Dai' 'Japanese' 'Karitiana' 'Lahu' 'Mandenka' 'Naxi' 'Papuan' 'Surui' 'Yi' 'Yoruba'};

% run bootstrap reps in parallel
% matlabpool open 4   

options.branch_sets = 1;
% fit Sardinian as two-way admixture
[trees,fits] = MixMapper(pop_data_reps(1:4),scaffold_pop_names,'Sardinian','',options);

% fit Mozabite as three-way admixture (with one branch off Sardinian)
[trees,fits] = MixMapper(pop_data_reps(1:4),scaffold_pop_names,'Sardinian','Mozabite',options);

% write tree from all-data run in Newick format
phytreewrite('tree1.tree',trees(1));
